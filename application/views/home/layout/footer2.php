<div class="page-container container footer-container">
   <div class="footer-thumblis">
      <div class="thumblist-title">Populyar axtarışlar</div>
      <ul>
         <li><a target="_blank" href="az/axtar/satis/yeni-tikili.html">Yeni tikili mənzillər</a></li>
         <li><a target="_blank" href="az/axtar/kiraye/heyet-evi-bag.html">Kirayə həyət evləri</a></li>
         <li><a target="_blank" href="az/ipoteka.html">İpotekaya mənzillər</a></li>
         <li><a target="_blank" href="az/bloq.html">Əmlak xəbərləri</a></li>
         <li><a target="_blank" href="az/biznez-merkezleri.html">Bakıda ofislər</a></li>
         <li><a target="_blank" href="az/axtar/satis/villa.html">Satılıq villalar</a></li>
         <li><a target="_blank" href="az/axtar/satis7a66.html?sort=&amp;region=&amp;district=&amp;metro=&amp;placemark=&amp;page=1&amp;number=&amp;property_type%5B0%5D=on&amp;property_type%5B1%5D=on&amp;property_type%5B2%5D=on&amp;property_type%5B3%5D=on&amp;property_type%5B5%5D=on&amp;property_type%5B6%5D=on&amp;property_type%5B8%5D=on&amp;property_type%5B9%5D=on&amp;property_type%5B10%5D=on&amp;room%5B0%5D=on&amp;room%5B1%5D=on&amp;room%5B2%5D=on&amp;room%5B3%5D=on&amp;room%5B4%5D=on&amp;room%5B5%5D=on&amp;priceFrom=&amp;priceTo=&amp;areaFrom=&amp;areaTo=&amp;floorFrom=&amp;floorTo=&amp;repair=1&amp;city=1">Satılıq evlər 2020</a></li>
         <li><a target="_blank" href="az/axtar/satis/kohne-tikili.html">Əmlak alqı-satqısı</a></li>
         <li><a target="_blank" href="az/yasayis-kompleksleri.html">Yaşayış kompleks mənzilləri</a></li>
         <li><a target="_blank" href="az/insaat-sirketleri.html">Bakıda təmir şirkətləri</a></li>
         <li><a target="_blank" href="az/axtar/kiraye-gunluk/yeni-tikili.html">Günlük kirayə mənzillər</a></li>
         <li><a target="_blank" href="az/axtar/satis/elanlar/yasamal.html">Yasamal rayonunda satılıq mənzillər</a></li>
         <li><a target="_blank" href="az/axtar/satis/elanlar/28-mall.html">28 Mall evlər</a></li>
         <li><a target="_blank" href="az/axtar/satis/elanlar/genclik.html">Gənclik metro evlər</a></li>
         <li><a target="_blank" href="az/axtar/satis/elanlar/20-yanvar.html">20 Yanvar ucuz evlər</a></li>
         <li><a target="_blank" href="az/axtar/satis9139.html?sort=&amp;region=&amp;district=&amp;metro=&amp;placemark=&amp;page=1&amp;type=1&amp;number=&amp;property_type%5B1%5D=on&amp;property_type%5B2%5D=on&amp;room%5B0%5D=on&amp;room%5B1%5D=on&amp;room%5B2%5D=on&amp;room%5B3%5D=on&amp;room%5B4%5D=on&amp;room%5B5%5D=on&amp;price_min=&amp;price_max=&amp;area_min=&amp;area_max=&amp;land_area_min=&amp;land_area_max=&amp;floor_min=&amp;floor_max=&amp;repair%5B0%5D=on&amp;city=1">Təmirsiz mənzillər</a></li>
      </ul>
   </div>
</div>
<footer class="footer">
   <div class="footer-navbar">
      <ul>
         <li>
            <a href="az/elan-yerlesdir.html">
               <svg class="icon icon-plusnew">
                  <use xlink:href="assets/site/img/icons/icons.svg#icon-plusnew"></use>
               </svg>
               <p><?= translate('add_listing') ?></p>
            </a>
         </li>
         <li>
            <a href="az/axtar.html">
               <svg class="icon icon-loupe">
                  <use xlink:href="assets/site/img/icons/icons.svg#icon-loupe"></use>
               </svg>
               <p>Axtar</p>
            </a>
         </li>
         <li>
            <a href="az/mene-ev-tap.html">
               <svg class="icon icon-home">
                  <use xlink:href="assets/site/img/icons/icons.svg#icon-home"></use>
               </svg>
               <p>Mənə ev tap</p>
            </a>
         </li>
      </ul>
   </div>
   <div class="page-container container">
      <div class="footer-primary">
         <div class="footer-primary__container container">
            <p><?= translate('follow_us_on_social_networks') ?></p>
            <div class="links">
               <a target="_blank" href="https://www.facebook.com/www.evelani.az" class="links-social links-facebook">
                  <svg class="icon icon-facebook">
                     <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-facebook"></use>
                  </svg>
               </a>
               <a target="_blank" href="https://www.instagram.com/evelani.az/" class="links-social links-instagram">
                  <svg class="icon icon-instagram">
                     <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-instagram"></use>
                  </svg>
               </a>
               <a target="_blank" href="https://www.youtube.com/channel/UCCrOZVl8IDhrV7AqbGK_FjQ" class="links-social links-youtube">
                  <svg class="icon icon-youtube">
                     <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-youtube"></use>
                  </svg>
               </a>
               <a target="_blank" href="https://www.linkedin.com/company/evelani-az/" class="links-social links-linkedin">
                  <svg class="icon icon-linkedin">
                     <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-linkedin"></use>
                  </svg>
               </a>
               <a target="_blank" href="https://twitter.com/EvelaniAz" class="links-social links-twitter">
                  <svg class="icon icon-twitter">
                     <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-twitter"></use>
                  </svg>
               </a>
               <a target="_blank" href="https://t.me/Evelani" class="links-social links-telegram">
                  <svg class="icon icon-telegram">
                     <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-telegram"></use>
                  </svg>
               </a>
            </div>
            <div class="footer-background d-none d-md-flex">
               <img src="assets/site/img/icons/footer%402x5760.png?v=2022-04-19%2000:11:03">
            </div>
         </div>
      </div>
      <div class="footer-secondary">
         <div class="footer-secondary__container container">
            <div class="footer-secondary__column footer-secondary--about">
               <a href="az.html" class="logo">
               <img src="site/img/logos/logo%402x5760.png?v=2022-04-19%2000:11:03">
               </a>
               <p>Evelani.az daşınmaz əmlakın satış və kirayəsi xidmətlərini digital sferada təqdim edən platformadır. Evelani.az saytı vasitəsilə daşınmaz əmlakınızın satış və kirayəsini, tez və interaktiv şəkildə təşkil edə, yüksək məhsuldarlıq əldə edə bilərsiniz.</p>
            </div>
            <div class="footer-secondary__column footer-nav  d-lg-flex">
               <h6>Ümumi</h6>
               <a href="az/istifadeci-razilasmasi.html">İstifadəçi razılaşması</a>
               <a href="az/haqqimizda.html">Haqqımızda</a>
               <a href="az/balansi-artirmaq.html">Balansı artır</a>
               <a href="az/reklam-yerlesdirmek.html">Reklam yerləşdir</a>
               <a href="az/sitemap.html" target="_blank">Saytın xəritəsi</a>
               <p class="footer-nav--date">© 2020 - 2022 Evelani.az</p>
            </div>
            <div class="footer-secondary__column footer-nav d-none d-lg-flex">
               <h6>Qısayollar</h6>
               <a href="az/agentlikler.html">Agentliklər</a>
               <a href="az/yasayis-kompleksleri.html">Yaşayış kompleksləri</a>
               <a href="az/insaat-sirketleri.html">İnşaat şirkətləri</a>
               <a href="az/biznez-merkezleri.html">Biznes mərkəzləri</a>
            </div>
            <div class="footer-secondary__column footer-contact d-none d-md-flex">
               <h6>Əlaqə</h6>
               <a href="tel:info@evelani.az"><span class="__cf_email__" data-cfemail="422b2c242d022734272e232c2b6c2338">[email&#160;protected]</span></a>
               <a href="tel:info@evelani.az"><span class="__cf_email__" data-cfemail="ec85828a83ac899a89808d8285c28d96">[email&#160;protected]</span></a>
               <a href="cdn-cgi/l/email-protection.html#e1888f878ea18497848d808f88cf809b"><span class="__cf_email__" data-cfemail="4b22252d240b2e3d2e272a2522652a31">[email&#160;protected]</span></a>
            </div>
         </div>
         <div class="footer-secondary__container container">
            <div class="footer-secondary__column footer-secondary--about" style="max-width: unset;">
               <p>© 2020 - 2022 Evelani.az | Bütün hüquqlar qorunur</p>
            </div>
         </div>
         <div class="scroll-up">
            <i class="fas fa-chevron-up"></i>
         </div>
      </div>
   </div>
</footer>
<script src="<?= base_url('assets/site/admin/jquery-3.3.1.min.js') ?>"></script>
<script src='<?= base_url('assets/site/admin/sweetalert2.all.min.js') ?>'></script>
<script src='<?= base_url('assets/site/admin/underscore-min.js') ?>'></script>
<script type="text/javascript">

        _.templateSettings.variable = "rc";

        let locale = 'az' ,
            csrf = "<?php echo $this->security->get_csrf_hash();?>",
            deleted_files = [] ,
            _map , _marker;

        
        function initMap( latitude = 40.4093 , longitude = 49.8671 )
        {
            var input = document.getElementById("pac-input");
            var searchBox = new google.maps.places.SearchBox(input);

            let defaultLocation = { lat: latitude , lng: longitude };

            _map = new google.maps.Map( document.getElementById( 'map' ) , { center: defaultLocation , zoom: 15 } );

            setLocation( defaultLocation );
            searchBox.addListener("places_changed", function( event ) {
                const places = searchBox.getPlaces();

                if (places.length == 0) {
                    return;
                }

                const bounds = new google.maps.LatLngBounds();
                places.forEach((place) => {
                    if (!place.geometry) {
                        console.log("Returned place contains no geometry");
                        return;
                    }

                    setLocation(place.geometry.location);

                    if (place.geometry.viewport) {
                        bounds.union(place.geometry.viewport);
                    } else {
                        bounds.extend(place.geometry.location);
                    }
                });
                _map.fitBounds(bounds);
            });
            google.maps.event.addListener( _map , 'click' , function( event ) { setLocation( { lat: event.latLng.lat() , lng: event.latLng.lng() } ); } );
        }

        function setLocation( location )
        {
            if( _marker !== undefined ) _marker.setMap( null );

            _marker = new google.maps.Marker( { position: location , map: _map } );

            $( '[name="latitude"]' ).val( location.lat );
            $( '[name="longitude"]' ).val( location.lng );
        }


        function loading( state = 0 , target = false )
        {
            if( state )
            {
                if( !target )
                {
                    $( '#loading' ).show();

                    $( 'body' ).addClass( 'loading-progress' );
                } else
                {
                    if( target.prop( 'tagName' ) == 'FORM' )
                    {
                        target.append( '<div class="loading"><svg class="spinner" viewBox="0 0 50 50"><circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle></svg></div>' );

                        if( target.find( 'button[type="submit"]' ).length ) target.find( 'button[type="submit"]' ).attr( 'disabled' , 'disabled' );
                    } else if( target.prop( 'tagName' ) == 'BUTTON' )
                    {
                        target.append( '<svg class="spinner" viewBox="0 0 50 50"><circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle></svg>' );

                        target.attr( 'disabled' , 'disabled' );
                    }
                }
            } else
            {
                if( !target )
                {
                    $( '#loading' ).hide();

                    $( 'body' ).removeClass( 'loading-progress' );
                } else
                {
                    target.find( '.loading' ).remove();

                    target.find( '.spinner' ).remove();

                    if( target.prop( 'tagName' ) == 'FORM' && target.find( 'button[type="submit"]' ).length ) target.find( 'button[type="submit"]' ).removeAttr( 'disabled' );

                    else if( target.prop( 'tagName' ) == 'BUTTON' ) target.removeAttr( 'disabled' );
                }
            }
        }


        function error( message = '' , title = "Xəta baş verdi" )
        {
            const swalWithBootstrapButtons = swal.mixin( {
                confirmButtonClass : 'btn btn-primary' ,
                buttonsStyling : false ,
            } );

            swalWithBootstrapButtons( {
                title : title ,
                text : message ,
                type : 'warning'
            } );

            loading();
        }


        function warning( title = "Xəta baş verdi" )
        {
            const swalWithBootstrapButtons = swal.mixin( {
                confirmButtonClass : 'btn btn-primary' ,
                buttonsStyling : false ,
            } );

            swalWithBootstrapButtons( {
                title : title ,
                type : 'warning'
            } );

            loading();
        }


        function init()
        {
            $( '.datetimepicker.dropdown-menu' ).remove();
            $( '.daterangepicker.dropdown-menu' ).remove();

            $( '[x-datetime]' ).each( function()
            {
                $( this ).datetimepicker( {
                    todayHighlight : true ,
                    pickerPosition : 'bottom-left' ,
                    autoclose : true ,
                    todayBtn : true ,
                    format : 'yyyy-mm-dd hh:ii:ss' ,
                    weekStart : 1 ,
                    locale : locale
                } );
            } );

            $( '[x-date]' ).each( function()
            {
                let t = $( this ) , weekday = t.attr( 'x-weekday' ) ,
                    $disabledWeekDays = weekday != undefined ? [ 0 , 1 , 2 , 3 , 4 , 5 , 6 ] : [];

                if( weekday != undefined )
                {
                    $disabledWeekDays = jQuery.grep( $disabledWeekDays , function( value )
                    {
                        return value != weekday;
                    } );
                }

                $( this ).datetimepicker( {
                    todayHighlight : true ,
                    pickerPosition : 'bottom-left' ,
                    autoclose : true ,
                    todayBtn : true ,
                    format : 'yyyy-mm-dd' ,
                    startView : 2 , minView : 2 , forceParse : 0 ,
                    weekStart : 1 ,
                    daysOfWeekDisabled : $disabledWeekDays ,
                    locale : locale
                } );
            } );

            $( '[x-date-range]' ).each( function()
            {
                let t = $( this ) , form = t.closest( 'form' );

                t.daterangepicker( {
                    todayHighlight : true ,
                    pickerPosition : 'bottom-left' ,
                    autoclose : true ,
                    todayBtn : true ,
                    autoUpdateInput : false ,
                    weekStart : 1 ,
                    locale : {
                        format : 'YYYY-MM-DD'
                    }
                } , function( start , end )
                {
                    t.val( start.format( 'YYYY-MM-DD' ) + ' - ' + end.format( 'YYYY-MM-DD' ) );

                    form.submit();
                } ).on( 'cancel.daterangepicker' , function()
                {
                    t.val( '' );

                    form.submit();
                } );
            } );

            $( '[x-select]' ).each( function()
            {
                $( this ).selectpicker();
            } );

            $( '[x-select-2]' ).each( function()
            {
                $( this ).select2();
            } );

            $( '[x-select-2-min]' ).each( function()
            {
                $( this ).select2( { minimumResultsForSearch : -1 } );
            } );

            $( '[x-select-2-url]' ).each( function()
            {
                let t = $( this ) , url = t.attr( 'x-select-2-url' ) , query = { <?php echo $this->security->get_csrf_token_name();?> : csrf } ,
                    column = t.attr( 'x-data-column' ) !== undefined ? t.attr( 'x-data-column' ) : false ,
                    value = t.attr( 'x-data-value' ) !== undefined ? t.attr( 'x-data-value' ) : null ,
                    foreign = t.attr( 'x-foreign' ) ,
                    input = t.closest( '[x-list-form]' ).find( '[name="' + foreign + '"]' );

                if( column ) query[ [ column ] ] = value;

                let column2 = t.attr( 'x-data-column2' ) !== undefined ? t.attr( 'x-data-column2' ) : false ,
                    value2 = t.attr( 'x-data-value2' ) !== undefined ? t.attr( 'x-data-value2' ) : null;
                if( column2 ) query[ [ column2 ] ] = value2;

                t.select2( {
                    ajax : {
                        url : url ,
                        type : 'POST' ,
                        data : function( params )
                        {
                            query.search = params.term;

                            if( input.length ) query[ [ foreign ] ] = input.val();

                            return query;
                        } ,
                        processResults : function( data )
                        {
                            return {
                                results : data.data
                            };
                        }
                    }
                } );
            } );

            $( '[x-text-editor]' ).each( function()
            {
                let t = $( this ) , name = t.attr( 'name' ) ,
                    height = t.attr( 'x-height' ) !== undefined ? t.attr( 'x-height' ) : 222;

                ClassicEditor.create( document.querySelector( '[name="' + name + '"]' ) , {
                    language: 'az',
                    toolbar: {
                        items: [
                            'heading',
                            '|',
                            'bold',
                            'italic',
                            'link',
                            'bulletedList',
                            'numberedList',
                            '|',
                            'indent',
                            'outdent',
                            '|',
                            'imageUpload',
                            'blockQuote',
                            'insertTable',
                            'mediaEmbed',
                            'undo',
                            'redo'
                        ]
                    },
                    image: {
                        styles: [
                            'alignLeft', 'alignCenter', 'alignRight'
                        ] ,
                        resizeOptions: [
                            {
                                name: 'resizeImage:original',
                                label: 'Orijinal ölçü',
                                value: null
                            },
                            {
                                name: 'resizeImage:25',
                                label: '25%',
                                value: 25
                            },
                            {
                                name: 'resizeImage:50',
                                label: '50%',
                                value: 50
                            },
                            {
                                name: 'resizeImage:75',
                                label: '75%',
                                value: 75
                            },
                            {
                                name: 'resizeImage:100',
                                label: '100%',
                                value: 100
                            }
                        ],
                        toolbar: [
                            'imageStyle:alignLeft', 'imageStyle:alignCenter', 'imageStyle:alignRight',
                            '|',
                            'resizeImage',
                            '|',
                            'imageTextAlternative'
                        ]
                    },
                    table: {
                        contentToolbar: [
                            'tableColumn',
                            'tableRow',
                            'mergeTableCells',
                            'tableCellProperties',
                            'tableProperties'
                        ]
                    }
                } )
                .then( editor => {
                    window.editor = editor;
                } )
                .catch( error => {
                    console.error( error );
                } );
            } );

            $( '[data-switch=true]' ).bootstrapSwitch();

            $( '#modalMap' ).on( 'hidden.bs.modal' , function()
            {
                setTimeout( function()
                {
                    if( $( '.modal' ).length )
                        $( 'body' ).addClass( 'modal-open' );
                    else
                        $( 'body' ).removeClass( 'modal-open' );

                } , 5 );
            } );

            loading();
        }


        function createModal( title , body , close = true , widthClass = 'my-col-xs-12' , buttons = '' , headerClass = '' )
        {
            let modalNumber = createModalHTML( widthClass , close );

            let m = $( "#newModal" + modalNumber );
            m.find( ".modal-content" ).children( ":not([do=loading] , .modal-header:eq(0) , .modal-body:eq(0) , .modal-footer:eq(0))" ).remove();
            if( m.find( ".modal-content" ).children( ".modal-body" ).length == 0 )
            {
                m.find( ".modal-content" ).append( '<div class="modal-body"></div>' );
            }
            if( m.find( ".modal-content" ).children( ".modal-footer" ).length == 0 )
            {
                //m.find( ".modal-content" ).append( '<div class="modal-footer"></div>' );
            }
            m.find( ".modal-header" ).addClass( headerClass );
            m.find( ".modal-title" ).html( title );
            m.find( ".modal-body-content" ).html( body );
            m.find( ".modal-footer" ).html( buttons );
            m.css( 'cssText' , 'z-index: ' + ( 12 + modalNumber * 2 ) + ' !important; margin: 5px; position: absolute;' );
            m.modal( "show" );

            $( '.modal-backdrop' ).eq( modalNumber - 1 ).css( 'cssText' , 'z-index: ' + ( 11 + modalNumber * 2 ) + ' !important' );

            if( m.find( '[x-modal-title]' ) ) m.find( '.modal-title' ).html( m.find( '[x-modal-title]' ).attr( 'x-modal-title' ) );

            if( m.find( '[x-modal-class]' ) ) m.find( '.modal-dialog' ).addClass( m.find( '[x-modal-class]' ).attr( 'x-modal-class' ) );

            return m;
        }

        function createModalHTML( widthClass , close )
        {
            var n = 1;
            while( $( "#newModal" + n ).length ) n++;
            var effects = [ "flipInX" , "flipInY" , "pulse" , "jello" , "fadeIn" ] ,
                effect = effects[ Math.floor( Math.random() * 111 ) % effects.length ];
            $( "#m_aside_right" ).append( '<div class="modal scroll fade" id="newModal' + n + '" role="dialog" ' + ( close ? '' : 'data-backdrop="static"' ) + '><div class="modal-dialog ' + effect + ' ' + widthClass + ' animated"><div class="modal-content"><div class = "modal-header" style = "width: 100%; position: relative; padding: 8px;"><h4 class = "modal-title" style="font-size: 21px; margin-left: 10px;"></h4><span class="close-modal" data-dismiss="modal" aria-label="Bağla" style="position:absolute; top: 9px; right: 9px; cursor: pointer;"><i class="la la-close" style="font-size: 30px; font-weight: bold;"></i></span></div><div class="modal-body scroll" style="height: ' + ( window.innerHeight - 190 ) + 'px;"><div class="row modal-body-content"></div></div></div></div></div></div>' );
            $( "#newModal" + n ).on( "hidden.bs.modal" , function()
            {
                $( this ).remove();
            } );
            return n;
        }


        function pagination( page , all , per , length , list = 'main' )
        {
            let show = 3 , count = Math.ceil( all / per ) , html = '';

            if( all )
            {
                html += '<ul class="m-datatable__pager-nav"><h5 style="color: #5f7beb;">Cəmi: ' + all + '</h5></ul>';
            }

            if( count > 1 )
            {
                html += '<ul class="m-datatable__pager-nav pull-right" style="margin-top: 5px; margin-left: 30px;">';

                if( page > 1 )
                {
                    html += '<li><a x-paginate="' + ( page - 1 ) + '" class="m-datatable__pager-link"><i class="la la-angle-left"></i></a></li>';
                }

                if( page > ( show + 1 ) )
                {
                    html += '<li><a x-paginate="1" class="m-datatable__pager-link">1</a></li>';

                    if( page > ( show + 2 ) )
                    {
                        html += '<li><a>. . .</a></li>';
                    }
                }

                for( let i = 1; i <= count; i++ )
                {
                    if( ( page > i && ( page - i ) <= show ) || ( page < i && ( i - page ) <= show ) || i === page )
                    {
                        html += '<li><a ' + ( i !== page ? 'x-paginate="' + i + '"' : '' ) + ' class="m-datatable__pager-link ' + ( i === page ? 'm-datatable__pager-link--active' : '' ) + '">' + i + '</a></li>';
                    }
                }

                if( ( count - page ) > show )
                {
                    if( ( count - page ) > ( show + 1 ) )
                    {
                        html += '<li><a>. . .</a></li>';
                    }

                    html += '<li><a x-paginate="' + count + '" class="m-datatable__pager-link">' + count + '</a></li>';
                }

                if( page < count )
                {
                    html += '<li><a x-paginate="' + ( page + 1 ) + '" class="m-datatable__pager-link"><i class="la la-angle-right"></i></a></li>';
                }
            }

            $( '[x-pagination="' + list + '"]' ).html( html );


            if( ( page - 1 ) * per + length < all ) $( '[x-more]' ).show();
            else $( '[x-more]' ).hide();
        }


        function checkboxList()
        {
            $( '[x-checkbox-list]' ).each( function()
            {
                let t = $( this ) ,
                    name = t.attr( 'x-checkbox-list' ) ,
                    f = t.closest( 'form' ) ,
                    parameters = [];

                if( t.find( '[x-checkbox-id]' ).length )
                {
                    t.find( '[x-checkbox-id]' ).each( function()
                    {
                        let i = $( this ) , id = i.attr( 'x-checkbox-id' );

                        if( id != undefined && i.prop( 'checked' ) )
                        {
                            parameters.push( id );
                        }
                    } );
                }

                if( name != undefined )
                {
                    if( name === 'roles' && t.find( '[x-checkbox-id="admin"]' ).prop( 'checked' ) )
                    {
                        f.find( '[name="' + name + '"]' ).val( 'admin' );
                    } else
                    {
                        f.find( '[name="' + name + '"]' ).val( parameters );
                    }
                }
            } );
        }


        function check( name , data )
        {
            $( '[name="' + name + '"]' ).val( data.join( ',' ) );

            for( let i in data ) $( '[x-checkbox-list="' + name + '"] [x-checkbox-id="' + data[ i ] + '"]' ).prop( 'checked' , true );
        }


        function media( url = '' )
        {
            if( url !== null && url !== undefined && url.length ) return url;

            return 'https://evelani.az/uploads/default.png?v=2022-04-26 00:15:21';
        }


        function images( data , minus = false )
        {
            if( data.images !== undefined && data.images.length )
            {
                $.each( data.images , function( i , image )
                {
                    if( minus ) image.id = -1 * image.id;

                    $( '[x-images]' ).append( _.template( $( 'script[x-image]' ).html() )( image ) );
                } );
            }
        }


        function translate( word )
        {
            let translations = {
                create_announcement : 'Elan ver' ,
                find_me_home : 'Mənə ev tap'
            };

            return translations[ word ];
        }


        $( document ).ready( function()
        {
            $( '[x-list-form="main"]' ).append( '<input type="hidden" name="page" value="1">' );

            

            $( document ).on( 'submit' , '[x-list-form]' , function( e )
            {
                e.preventDefault();

                loading( 1 );

                let t = $( this ) , formData = new FormData( this ) , html = '' , body = t.find( '[x-list-tbody]' ) ,
                    list = t.attr( 'x-list-form' ) ,
                    modal = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'tr';

                formData.append( '<?php echo $this->security->get_csrf_token_name();?>' , csrf );

                $.ajax( {
                    type : 'POST' ,
                    url : t.attr( 'action' ) ,
                    data : formData ,
                    cache : false ,
                    contentType : false ,
                    processData : false ,
                    success : function( res )
                    {
                        if(
                            res &&
                            typeof ( res[ 'data' ] ) !== 'undefined' &&
                            typeof ( res[ 'all' ] ) !== 'undefined' &&
                            typeof ( res[ 'page' ] ) !== 'undefined' &&
                            typeof ( res[ 'per' ] ) !== 'undefined'
                        )
                        {
                            let data = res[ 'data' ] ,
                                all = res[ 'all' ] ,
                                page = res[ 'page' ] ,
                                per = res[ 'per' ];

                            if( data.length )
                            {
                                let k = 1;

                                for( let i in data )
                                {
                                    data[ i ][ 'no' ] = k++;

                                    html += _.template( $( 'script[x-' + modal + ']' ).html() )( data[ i ] );
                                }
                            } else
                            {
                                html = '<tr><td colspan="55" style="text-align: center;"><h4>Heç bir məlumat yoxdur!</h4></td></tr>';
                            }

                            pagination( page , all , per , data.length , list );

                            if( t.find( '[x-more]' ).length )
                            {
                                if( page == 1 ) body.html( '' );

                                body.append( html );
                            } else body.html( html );

                                                        body.closest( '.scroll' ).animate( { scrollTop : 0 } , 'slow' );
                            
                            if( $.isFunction( window.afterList ) ) afterList( t , res );

                            loading();
                        } else
                        {
                            error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                        }
                    } ,
                    error : function( res )
                    {
                        error( 'Network error!' );
                    }
                } );
            } );


            $( document ).on( 'click' , '[x-paginate]' , function()
            {
                let page = $( this ).attr( 'x-paginate' ) ,
                    list = $( this ).closest( '[x-pagination]' ).attr( 'x-pagination' );

                $( '[x-list-form="' + list + '"] [name="page"]' ).val( page );

                $( '[x-list-form="' + list + '"]' ).submit();
            } );


            $( document ).on( 'change' , '[x-per]' , function()
            {
                let per = $( this ).val();

                $( '[x-list-form="main"] [name="per"]' ).val( per );

                $( '[x-list-form="main"]' ).submit();
            } );


            $( document ).on( 'change' , '[x-search]' , function()
            {
                let search = $( this ).val();

                $( '[x-list-form="main"] [name="search"]' ).val( search );

                $( '[x-list-form="main"]' ).submit();
            } );


            $( document ).on( 'change' , '[x-list-form] select' , function()
            {
                if( $( this ).attr( 'x-no-submit' ) === undefined ) $( this ).closest( '[x-list-form]' ).submit();
            } );


            $( document ).on( 'change' , '[x-list-form] input' , function()
            {
                if( $( this ).attr( 'x-activate-url' ) === undefined && $( this ).attr( 'x-no-submit' ) === undefined ) $( this ).closest( '[x-list-form]' ).submit();
            } );


            $( document ).on( 'click' , '[x-edit-url]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) ,
                    id = tr.attr( 'x-tr-id' ) , xId = t.attr( 'x-modal-id' ) ,
                    url = t.attr( 'x-edit-url' ) ,
                    _modal = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'edit-modal' ,
                    list = t.closest( '[x-list-form]' ).attr( 'x-list-form' ) ,
                    column = t.attr( 'x-data-column' ) !== undefined ? t.attr( 'x-data-column' ) : false ,
                    value = t.attr( 'x-data-value' ) !== undefined ? t.attr( 'x-data-value' ) : null;

                id = xId !== undefined ? xId : id;

                $.post( url , {
                    'id' : id ,
                    '<?php echo $this->security->get_csrf_token_name();?>' : csrf
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        res[ 'data' ][ 'x_list_form' ] = list;

                        if( column ) res[ 'data' ][ [ column ] ] = value;

                        let info = _.template( $( 'script[x-' + _modal + ']' ).html() )( res[ 'data' ] ) ,
                            modal = createModal( 'Düzəliş et' , '<div class="modal-body">' + info + '</div>' , false );

                        setTimeout( function()
                        {
                            init();

                            $( '[x-checkbox-list]' ).each( function()
                            {
                                var t = $( this ) , name = t.attr( 'x-checkbox-list' ) ,
                                    max = t.attr( 'x-checkbox-max' );

                                if( res.data[ name ] != undefined && res.data[ name ].length )
                                {
                                    if( $.type( res.data[ name ] ) == 'string' )
                                    {
                                        let variants = res.data[ name ].split( ',' );

                                        if( name === 'roles' && variants == 'admin' )
                                        {
                                            $( '[x-checkbox-list="' + name + '"] [x-checkbox-id]' ).prop( 'checked' , true );
                                        } else if( variants.length )
                                        {
                                            $.each( variants , function( k , variant )
                                            {
                                                $( '[x-checkbox-list="' + name + '"] [x-checkbox-id="' + variant + '"]' ).prop( 'checked' , true );
                                            } );
                                        }

                                        if( max !== undefined && variants.length >= max )
                                        {
                                            $( '[x-checkbox-list="' + name + '"] [x-checkbox-id]:not(:checked)' ).prop( 'disabled' , true );
                                            $( '[x-checkbox-list="' + name + '"] [x-checkbox-id]:not(:checked)' ).closest( 'label' ).addClass( 'disabled' );
                                        }
                                    }
                                }
                            } );

                            new mPortlet( 'm_portlet_tools_role' );

                            if( $.isFunction( window.loadDependencies ) ) loadDependencies( res.data );

                            setTimeout( function()
                            {
                                checkboxList();
                            } , 55 );
                        } , 5 );
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'click' , '[x-add]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , _modal = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'edit-modal' ,
                    list = t.closest( '[x-list-form]' ).attr( 'x-list-form' ) ,
                    column = t.attr( 'x-data-column' ) !== undefined ? t.attr( 'x-data-column' ) : false ,
                    value = t.attr( 'x-data-value' ) !== undefined ? t.attr( 'x-data-value' ) : null ,
                    data = { x_list_form : list };

                if( column ) data[ [ column ] ] = value;

                let info = _.template( $( 'script[x-' + _modal + ']' ).html() )( data ) ,
                    modal = createModal( 'Əlavə et' , '<div class="modal-body">' + info + '</div>' , false );

                setTimeout( function()
                {
                    init();

                    new mPortlet( 'm_portlet_tools_role' );

                    if( $.isFunction( window.addDependency ) ) addDependency();
                } , 5 );
            } );


            $( document ).on( 'click' , '[x-tab-title]' , function()
            {
                let t = $( this ) ,
                    step = Number( t.attr( 'x-tab-title' ) ) ,
                    form = t.closest( 'form' ) ,
                    id = Number( form.find( '[name="id"]' ).val() ) ,
                    button = form.find( '[x-submit]' ) ,
                    last = Number( button.attr( 'x-submit' ) );

                if( !id )
                {
                    button.attr( 'x-step' , step );

                    button.attr( 'type' , step === last ? 'submit' : 'button' );

                    button.text( step === last ? 'Add' : 'Next' );
                }
            } );


            $( document ).on( 'click' , '[x-submit]' , function()
            {
                let button = $( this ) ,
                    step = Number( button.attr( 'x-step' ) ) ,
                    form = button.closest( 'form' ) ,
                    id = Number( form.find( '[name="id"]' ).val() ) ,
                    last = Number( button.attr( 'x-submit' ) );

                step++;

                if( !id )
                {
                    setTimeout( function()
                    {
                        $( '[x-tab-title="' + step + '"]' ).click();
                    } , 5 );
                }
            } );


            $( document ).on( 'click' , '[x-add-new]' , function()
            {
                let button = $( this ) ,
                    form = button.closest( 'form' );

                form.append( '<input type="hidden" name="add_new" value="1">' );

                form.submit();

            } );


            $( document ).on( 'submit' , '[x-edit-form]' , function( e )
            {
                e.preventDefault();

                let t = $( this ) , formData = new FormData( this ) , url = t.attr( 'action' ) ,
                    list = t.attr( 'x-list' ) !== undefined ? t.attr( 'x-list' ) : 'main' ,
                    target = t.attr( 'x-target' ) , targetWithData = t.attr( 'x-target-with-data' ) ,
                    addNew = t.find( '[name="add_new"]' ).length ? Number( t.find( '[name="add_new"]' ).val() ) : 0 ,
                    edit = t.find( '[name="id"]' ) !== undefined;

                 loading( 1 , t );
                
                t.find( '[name]' ).each( function()
                {
                    let _t = $( this ) , name = _t.attr( 'name' );

                    _t.css( 'border-color' , '#ebedf2' );
                    _t.prev( 'label' ).css( 'color' , '#575962' );
                } );

                t.find( '[for]' ).css( 'color' , '#575962' );
                t.find( '[x-tab-title]' ).css( 'color' , '#575962' );

                t.find( '[x-validations]' ).html( '' );

                formData.append( '<?php echo $this->security->get_csrf_token_name();?>' , csrf );

                $.ajax( {
                    type : 'POST' ,
                    url : url ,
                    data : formData ,
                    cache : false ,
                    contentType : false ,
                    processData : false ,
                    success : function( res )
                    {
                        res = JSON.parse(res);
                        if( res[ 'status' ] === 'success' )
                        {
                            if( res.validations !== undefined && Object.keys( res.validations ).length )
                            {
                                $.each( res.validations , function( name , v )
                                {
                                    let tab = t.find( '[name="' + name + '"]' ).closest( '[x-tab]' ).attr( 'id' );

                                    t.find( '[for="' + name + '"]' ).css( 'color' , 'red' );

                                    if( target == 'afterAddEmployee' ) t.find( '[name="' + name + '"]' ).css( 'border-color' , 'red' );

                                    
                                    t.find( '[x-tab-title][href="#' + tab + '"]' ).css( 'color' , 'red' );

                                    if( $( 'script[x-validation]' ).length )
                                    {
                                        $.each( v , function( k , m )
                                        {
                                            t.find( '[x-validations]' ).append( _.template( $( 'script[x-validation]' ).html() )( { message : m } ) );
                                        } );
                                    }
                                } );
                            } else
                            {
                                if( targetWithData && typeof window[ targetWithData ] === 'function' )
                                {
                                    window[ targetWithData ]( res );
                                } else if( target && typeof window[ target ] === 'function' )
                                {
                                    window[ target ]();
                                } else if( $.isFunction( window.editFormCallback ) ) editFormCallback( res );
                                else
                                {
                                    let title = res.title !== undefined ? res.title : '' ,
                                        text = res.text !== undefined ? res.text : '';

                                    const swalWithBootstrapButtons = swal.mixin( {
                                        confirmButtonClass : 'btn btn-primary' ,
                                        buttonsStyling : false
                                    } );

                                    swalWithBootstrapButtons( {
                                        type : 'success' ,
                                        title : title ,
                                        text : text ,
                                        showConfirmButton : false ,
                                        timer : addNew ? 1000 : 3000
                                    } );

                                    if( addNew )
                                    {
                                        t.trigger( 'reset' );

                                        t.find( '[name="add_new"]' ).remove();
                                    }

                                    if( t.attr( 'x-redirect-url' ) !== undefined )
                                    {
                                        location.href = t.attr( 'x-redirect-url' );
                                    } else if( t.closest( '.modal' ).length )
                                    {
                                        $( '[x-list-form="' + list + '"]' ).submit();

                                        if( !addNew ) t.closest( '.modal' ).modal( 'hide' );
                                    } else
                                    {
                                        //
                                    }
                                }
                            }

                             loading( 0 , t );                         } else
                        {
                            error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                        }
                    } ,
                    error : function( res )
                    {
                        error( 'Network error!' );
                    }
                } );
            } );


            $( document ).on( 'submit' , '[x-edit-confirm-form]' , function( e )
            {
                e.preventDefault();

                loading( 1 );

                let t = $( this ) , formData = new FormData( this ) , url = t.attr( 'action' ) ,
                    list = t.attr( 'x-list' ) !== undefined ? t.attr( 'x-list' ) : 'main' ,
                    title = t.attr( 'x-modal-confirm-title' );

                const swalWithBootstrapButtons = swal.mixin( {
                    confirmButtonClass : 'btn btn-primary' ,
                    cancelButtonClass : 'btn btn-dark' ,
                    buttonsStyling : false ,
                } );

                swalWithBootstrapButtons( {
                    title : title ,
                    type : 'warning' ,
                    showCancelButton : true ,
                    confirmButtonText : "Bəli" ,
                    cancelButtonText : "No" ,
                    reverseButtons : true
                } ).then( ( r ) =>
                {
                    if( r.value )
                    {
                        loading( 1 );

                        t.find( '[name]' ).each( function()
                        {
                            let _t = $( this ) , name = _t.attr( 'name' );

                            _t.css( 'border-color' , '#ebedf2' );
                            _t.prev( 'label' ).css( 'color' , '#575962' );
                        } );

                        t.find( '[for]' ).css( 'color' , '#575962' );
                        t.find( '[x-tab-title]' ).css( 'color' , '#575962' );

                        formData.append( '<?php echo $this->security->get_csrf_token_name();?>' , csrf );

                        $.ajax( {
                            type : 'POST' ,
                            url : url ,
                            data : formData ,
                            cache : false ,
                            contentType : false ,
                            processData : false ,
                            success : function( res )
                            {
                                if( res[ 'status' ] === 'success' )
                                {
                                    if( res.validations !== undefined && Object.keys( res.validations ).length )
                                    {
                                        $.each( res.validations , function( name , v )
                                        {
                                            let tab = t.find( '[name="' + name + '"]' ).closest( '[x-tab]' ).attr( 'id' );

                                            t.find( '[name="' + name + '"]' ).css( 'border-color' , 'red' );
                                            t.find( '[name="' + name + '"]' ).prev( 'label' ).css( 'color' , 'red' );
                                            t.find( '[for="' + name + '"]' ).css( 'color' , 'red' );

                                            t.find( '[x-tab-title][href="#' + tab + '"]' ).css( 'color' , 'red' );
                                        } );
                                    } else
                                    {
                                        let title = res.title !== undefined ? res.title : '' ,
                                            text = res.text !== undefined ? res.text : '';

                                        const swalWithBootstrapButtons = swal.mixin( {
                                            confirmButtonClass : 'btn btn-primary' ,
                                            buttonsStyling : false
                                        } );

                                        swalWithBootstrapButtons( {
                                            type : 'success' ,
                                            title : title ,
                                            text : text ,
                                            showConfirmButton : false ,
                                            timer : 3000
                                        } );

                                        if( t.attr( 'x-redirect-url' ) !== undefined )
                                        {
                                            location.href = t.attr( 'x-redirect-url' );
                                        } else if( t.closest( '.modal' ).length )
                                        {
                                            $( '[x-list-form="' + list + '"]' ).submit();

                                            t.closest( '.modal' ).modal( 'hide' );
                                        } else
                                        {
                                            //
                                        }
                                    }

                                    loading();
                                } else
                                {
                                    error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                                }
                            } ,
                            error : function( res )
                            {
                                error( 'Network error!' );
                            }
                        } );
                    } else loading();
                } );

            } );


            $( document ).on( 'click' , '[x-view-url]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) , id = tr.attr( 'x-tr-id' ) ,
                    url = t.attr( 'x-view-url' ) ,
                    column = t.attr( 'x-modal-column' ) , xId = t.attr( 'x-modal-id' ) ,
                    modal_ = t.attr( 'x-modal' );

                column = column !== undefined ? column : 'id';

                id = xId !== undefined ? xId : id;

                modal_ = modal_ !== undefined ? modal_ : 'x-view-modal';

                $.post( url , {
                    [ column ] : id ,
                    '<?php echo $this->security->get_csrf_token_name();?>' : csrf
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        var info = _.template( $( 'script[' + modal_ + ']' ).html() )( res[ 'data' ] ) ,
                            modal = createModal( 'Məlumat' , '<div class="modal-body">' + info + '</div>' );

                        if( $.isFunction( window.loadDependencies ) ) loadDependencies( res.data );

                        loading();
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'click' , '[x-modal-url]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) ,
                    id = t.attr( 'x-modal-id' ) !== undefined ? t.attr( 'x-modal-id' ) : tr.attr( 'x-tr-id' ) ,
                    url = t.attr( 'x-modal-url' ) , column = t.attr( 'x-modal-column' ) ,
                    dataColumn = t.attr( 'x-data-column' ) !== undefined ? t.attr( 'x-data-column' ) : '___' ,
                    dataValue = t.attr( 'x-data-value' ) !== undefined ? t.attr( 'x-data-value' ) : null;

                column = column !== undefined ? column : 'id';

                $.post( url , {
                    [ column ] : id ,
                    [ dataColumn ] : dataValue ,
                    '<?php echo $this->security->get_csrf_token_name();?>' : csrf
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        modal = createModal( 'Məlumat' , '<div class="modal-body">' + res[ 'data' ] + '</div>' );

                        setTimeout( function()
                        {
                            modal.find( '[x-list-form]' ).submit();

                            init();
                        } , 5 );
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'change' , '[x-activate-url]' , function( e )
            {
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , url = t.attr( 'x-activate-url' ) , xId = t.attr( 'x-modal-id' ) ,
                    id = t.closest( '[x-tr-id]' ).attr( 'x-tr-id' ) ,
                    active = Number( t.prop( 'checked' ) ) , column = t.attr( 'x-modal-column' );

                id = xId !== undefined ? xId : id;

                column = column !== undefined ? column : 'active';

                $.post( url , {
                    'id' : id ,
                    '<?php echo $this->security->get_csrf_token_name();?>' : csrf ,
                    [ column ] : active
                } ).done( function( res )
                {
                    if( res[ 'status' ] === 'success' )
                    {
                        loading();
                    } else
                    {
                        error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                    }
                } ).fail( function()
                {
                    error( 'Network error!' );
                } );
            } );


            $( document ).on( 'change , click' , '[x-change-url]' , function( e )
            {
                e.stopPropagation();

                let t = $( this ) , url = t.attr( 'x-change-url' ) ,
                    xId = t.attr( 'x-modal-id' ), id = t.closest( '[x-tr-id]' ).attr( 'x-tr-id' ) ,
                    value = t.val() ,
                    column = t.attr( 'x-modal-column' ) !== undefined ? t.attr( 'x-modal-column' ) : 'status' ,
                    title = t.attr( 'x-change-modal-title' ) !== undefined ? t.attr( 'x-change-modal-title' ) : 'Sure to change status?' ,
                    form = t.closest( '[x-list-form]' );

                id = xId !== undefined ? xId : id;

                const swalWithBootstrapButtons = swal.mixin( {
                    confirmButtonClass : 'btn btn-primary' ,
                    cancelButtonClass : 'btn btn-dark' ,
                    buttonsStyling : false ,
                } );

                swalWithBootstrapButtons( {
                    title : title ,
                    type : 'warning' ,
                    showCancelButton : true ,
                    confirmButtonText : "Bəli" ,
                    cancelButtonText : "Ləğv et" ,
                    reverseButtons : true
                } ).then( ( r ) =>
                {
                    if( r.value )
                    {
                        loading( 1 );

                        $.post( url , {
                            'id' : id ,
                            '<?php echo $this->security->get_csrf_token_name();?>' : csrf ,
                            [ column ] : value
                        } ).done( function( res )
                        {
                            if( res[ 'status' ] === 'success' )
                            {
                                $( '[x-list-form="main"]' ).submit();

                                t.closest( '.modal' ).modal( 'hide' );

                                loading();
                            } else
                            {
                                error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                            }
                        } ).fail( function()
                        {
                            error( 'Network error!' );
                        } );
                    } else form.submit();
                } );
            } );


            $( document ).on( 'click' , '[x-checkbox-id]' , function()
            {
                let t = $( this ) , name = t.attr( 'x-checkbox-id' ) ,
                    p = t.closest( '[x-checkbox-list]' ) , p_name = p.attr( 'x-checkbox-list' ) ,
                    max = p.attr( 'x-checkbox-max' ) ,
                    group = t.closest( '[x-checkbox-group="' + name + '"]' ) ,
                    state = t.prop( 'checked' )
                ;

                if( p_name === 'roles' )
                {
                    if( name === 'admin' ) p.find( '[x-checkbox-id]' ).prop( 'checked' , state );

                    else if( !state ) p.find( '[x-checkbox-id="admin"]' ).prop( 'checked' , false );

                    else if( p.find( '[x-checkbox-id]:checked' ).length + 1 === p.find( '[x-checkbox-id]' ).length ) p.find( '[x-checkbox-id="admin"]' ).prop( 'checked' , true );
                }

                if( max !== undefined )
                {
                    if( p.find( '[x-checkbox-id]:checked' ).length >= max )
                    {
                        p.find( '[x-checkbox-id]:not(:checked)' ).prop( 'disabled' , 'disabled' );

                        p.find( '[x-checkbox-id]:not(:checked)' ).closest( 'label' ).addClass( 'disabled' );
                    } else
                    {
                        p.find( '[x-checkbox-id]' ).prop( 'disabled' , '' );

                        p.find( '[x-checkbox-id]:not(:checked)' ).closest( 'label' ).removeClass( 'disabled' );
                    }
                }

                if( group !== undefined && group.length && group.find( '[x-checkbox-id]' ).length ) group.find( '[x-checkbox-id]' ).prop( 'checked' , state );

                t.parents( '[x-checkbox-group]' ).each( function()
                {
                    let _t = $( this ) , _name = _t.attr( 'x-checkbox-group' );

                    if( !state || ( _t.find( '[x-checkbox-id]:checked' ).length + 1 === _t.find( '[x-checkbox-id]' ).length && _name !== 'admin' ) ) $( '[x-checkbox-id="' + _name + '"]' ).prop( 'checked' , state );
                } );

                setTimeout( function()
                {
                    checkboxList();
                } , 5 );
            } );


            $( document ).on( 'keyup' , '[x-checkbox-search]' , function()
            {
                let t = $( this ) , search = t.val().trim().toLowerCase() , name = t.attr( 'x-checkbox-search' );

                $( '[x-checkbox-list="' + name + '"]' ).find( 'label' ).each( function ()
                {
                    if ( $( this ).text().toLowerCase().indexOf( search ) == -1 ) $( this ).closest( 'div' ).hide();

                    else $( this ).closest( 'div' ).show();
                } );
            } );


            $( document ).on( 'keyup' , '[x-menu-search]' , function()
            {
                let t = $( this ) , search = t.val().trim().toLowerCase();

                $( 'li.m-menu__item' ).each( function ()
                {
                    if ( $( this ).find( '.m-menu__link-text' ).text().toLowerCase().indexOf( search ) == -1 ) $( this ).hide();

                    else $( this ).show();
                } );
            } );


            $( document ).on( 'click' , '[x-delete-url]' , function( e )
            {
                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) , url = t.attr( 'x-delete-url' ) ,
                    _with = t.attr( 'x-with' ) , _with_id = t.attr( 'x-with-id' ) ,
                    id = tr.attr( 'x-tr-id' );


                const swalWithBootstrapButtons = swal.mixin( {
                    confirmButtonClass : 'btn btn-dark' ,
                    cancelButtonClass : 'btn btn-primary' ,
                    buttonsStyling : false ,
                } );

                swalWithBootstrapButtons( {
                    title : "Silmək istədiyinizdən əminsinizmi?" ,
                    type : 'warning' ,
                    showCancelButton : true ,
                    confirmButtonText : "Bəli" ,
                    cancelButtonText : "Ləğv et" ,
                    reverseButtons : true
                } ).then( ( r ) =>
                {
                    if( r.value )
                    {
                        loading( 1 );

                        $.post( url , {
                            'id' : id ,
                            [ _with ] : _with_id ,
                            '<?php echo $this->security->get_csrf_token_name();?>' : csrf
                        } ).done( function( res )
                        {
                            if( res[ 'status' ] === 'success' )
                            {
                                tr.fadeOut( function()
                                {
                                    $( this ).remove();
                                } );

                                if( $.isFunction( window.__u ) ) __u();

                                loading();
                            } else
                            {
                                error( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : '' ) );
                            }
                        } ).fail( function()
                        {
                            error( 'Network error!' );
                        } );
                    }
                } );
            } );


            $( document ).on( 'keydown' , '[x-no-enter]' , function( e )
            {
                if( e.keyCode === 13 )
                {
                    e.preventDefault();
                    return false;
                }
            } );


            $( document ).on( 'change' , '[x-photo-input]' , function( e )
            {
                let ext = e.target.files[ 0 ][ 'name' ].replace( /^.*\./ , '' ).toLowerCase() ,
                    t = $( this ) , name = t.attr( 'x-photo-input' ) ,
                    img = t.closest( '[x-photo]' ).find( '[x-photo-img="' + name + '"]' );

                if( ext == 'jpeg' || ext == 'png' || ext == 'jpg' || 'gif' )
                {
                    img.attr( 'src' , URL.createObjectURL( e.target.files[ 0 ] ) );
                } else
                {
                    t.val( '' );

                    img.attr( 'src' , img.attr( 'x-photo-default' ) );

                    error( '' , 'Select valid image extension' );
                }
            } );


            $( document ).on( 'change' , '[x-file-input]' , function( e )
            {
                let t = $( this ) , val = t.val() , name = t.attr( 'x-file-input' ) ,
                    _file = t.closest( '[x-file]' ).find( '[x-file-a="' + name + '"]' );

                if( val ) _file.hide();
                else _file.show();
            } );


            $( document ).on( 'click' , '[x-modal-view]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                loading( 1 );

                let t = $( this ) , tr = t.closest( '[x-tr-id]' ) ,
                    modal_ = t.attr( 'x-modal' ) !== undefined ? t.attr( 'x-modal' ) : 'x-view-modal' ,
                    title = t.attr( 'x-modal-title' ) !== undefined ? t.attr( 'x-modal-title' ) : 'Info' ,
                    data = {
                        id : t.attr( 'x-modal-id' ) !== undefined ? t.attr( 'x-modal-id' ) : tr.attr( 'x-tr-id' ) ,
                        column : t.attr( 'x-data-column' ) !== undefined ? t.attr( 'x-data-column' ) : '___' ,
                        value : t.attr( 'x-data-value' ) !== undefined ? t.attr( 'x-data-value' ) : null
                    } ,
                    info = _.template( $( 'script[' + modal_ + ']' ).html() )( data ) ,
                    modal = createModal( title , '<div class="modal-body">' + info + '</div>' );

                setTimeout( function()
                {
                    init();
                } , 55 );

                loading();
            } );

            $( document ).keyup( function( e )
            {
                if( e.keyCode == 27 ) $( '.close-modal:last' ).click();
            } );


            $( document ).on( 'keyup' , '[x-front-search]' , function( e )
            {
                let t = $( this ) , name = t.attr( 'x-front-search' ) , search = t.val().trim().toLowerCase() ,
                    form = t.closest( 'form' ) , list = form.find( 'tbody' );

                form.find( '[x-front-search-show]' ).each( function()
                {
                    let i = $( this );

                    if( i.find( '[x-front-search-for="' + name + '"]' ).text().toLowerCase().includes( search ) ) i.removeClass( 'hidden_' + name );
                    else i.addClass( 'hidden_' + name );
                } );

                if( e.keyCode === 13 )
                {
                    e.preventDefault();
                    return false;
                }
            } );


            $( document ).on( 'click' , '[x-selectbox-id]' , function()
            {
                let t = $( this ) ,
                    form = t.closest( '[x-selectbox-area]' ).length ? t.closest( '[x-selectbox-area]' ) : t.closest( 'form' ) ,
                    checked = t.prop( 'checked' ) ,
                    name = t.attr( 'x-selectbox-id' );

                if( name == 'all' )
                {
                    if( checked ) form.find( '[x-selectbox-id]' ).prop( 'checked' , true );
                    else form.find( '[x-selectbox-id]' ).prop( 'checked' , false );
                } else
                {
                    if( !checked ) form.find( '[x-selectbox-id="all"]' ).prop( 'checked' , false );

                    if( !form.find( '[x-selectbox-id]:not(checked)' ).length ) form.find( '[x-selectbox-id="all"]' ).prop( 'checked' , true );
                }

                if( form.find( '[x-selectbox-id]:checked' ).length )
                {
                    $( '[x-event-representative-add-button]' ).removeClass( 'hidden' );

                    form.find( '[x-multi-select-button]' ).removeAttr( 'disabled' );
                } else
                {
                    $( '[x-event-representative-add-button]' ).addClass( 'hidden' );

                    form.find( '[x-multi-select-button]' ).attr( 'disabled' , true );
                }
            } );


            $( document ).on( 'click' , '[x-image-id] [x-image-delete]' , function( e )
            {
                e.stopPropagation();
                e.preventDefault();

                let div = $( this ).closest( '[x-image-id]' ) , id = div.attr( 'x-image-id' );

                deleted_files.push( id );

                $( '[name="deleted_files"]' ).val( JSON.stringify( deleted_files ) );

                div.fadeOut( function()
                {
                    $( this ).remove();
                } );
            } );


            $( document ).on( 'click' , '[x-make-same]' , function( e )
            {
                e.preventDefault();
                e.stopPropagation();

                let t = $( this ) , form = t.closest( 'form' ) ,
                    target = form.find( '[name="' + t.attr( 'x-make-same' ) + '"]' ) ,
                    source = form.find( '[name="' + target.attr( 'x-same-with' ) + '"]' );

                target.val( source.val() );
                target.prev( 'div' ).find( '[contenteditable]' ).html( source.val() );
            } );


            $( document ).on( 'click' , '[x-more]' , function()
            {
                let t = $( this ) ,
                    form = t.closest( 'form' ) ,
                    input = form.find( '[name="page"]' ) ,
                    page = input.val();

                input.val( ++page );

                form.submit();
            } );


            $( document ).on( 'click' , '[x-export]' , function()
            {
                let t = $( this ) , form = t.closest( 'form' );

                window.open( t.attr('x-export') + '?' + form.serialize() , '_blank' );
            } );


            
            $( '[x-list-form="main"]' ).submit();
        } )
        ;
    </script>
<script> let HIDE_MAP = 'Xəritəni gizlət'; </script>
<script src="<?= base_url() ?>assets/site/js/popper.js"></script>
<script src="<?= base_url() ?>assets/site/js/jquery-ui.js"></script>
<script src="<?= base_url() ?>assets/site/js/libs.min.js"></script>
<script src="<?= base_url() ?>assets/site/js/bootstrap-swipe-carousel.min.js"></script>
<script src="<?= base_url() ?>assets/site/js/lightslider.js"></script>
<script src="<?= base_url() ?>assets/site/js/isotope-docs.min.js"></script>
<script src="<?= base_url() ?>assets/site/js/semantic.min.js"></script>
<script src="<?= base_url() ?>assets/site/js/common.js"></script>
<script src="<?= base_url() ?>assets/site/js/js/select2.full.js"></script>
<script>
    function numberWithSpaces(x) {
        return x.toString().replace(/\B(?=(\d{3})+(?!\d))/g, ",");
    }
    eles = document.getElementsByClassName("pricemain");
    for(var i in eles) {
        var p = eles[i].innerText;
        if(parseInt(p) > 999){
            eles[i].innerText=numberWithSpaces(p);
        }
    }
</script>
<script>
            function afterRegister( data )
            {
                let modal = $( '[x-target-with-data="afterRegister"]' ).closest( '.modal' );

                modal.html( _.template( $( 'script[x-email-success]' ).html() )( { title : 'Qeydiyyat təsdiq linki göndərildi' , text : data.text } ) );

                modal.addClass( 'modal--small modal-message' );
            }


            function afterForgotPassword( data )
            {
                let modal = $( '[x-target-with-data="afterForgotPassword"]' ).closest( '.modal' );

                modal.html( _.template( $( 'script[x-email-success]' ).html() )( { title : 'Şifrə yeniləmə linki göndərildi' , text : data.text } ) );

                modal.addClass( 'modal--small modal-message' );
            }


            

            function afterLogin( data ) { location.reload(); }


            function afterWishlist( data )
            {
                let id = data.announcement , result = data.result , favorites = data.favorites ,
                    form = $( '[x-target-with-data="afterWishlist"][x-edit-form="' + id + '"]' ) ,
                    svg_area = form.find( 'button' ) ,
                    svg = `
                                <svg class="icon icon-heart` + ( result ? '' : '-outline' ) + `">
                                    <use xlink:href="https://evelani.az/site/img/icons/icons.svg?v=2022-04-26 00:15:21#icon-heart` + ( result ? '' : '-outline' ) + `"></use>
                                </svg>
                        `
                    , text_area = form.find( '[x-wishlist-text]' )
                    , text_area_m = form.find( '[x-wishlist-text-m]' )
                    , text = result ? 'Seçilmişlərdən çıxart' : 'Seçilmişlərə əlavə et'
                    , text_m = result ? 'Seçilmişlərdən çıxart' : 'Seçilmişlərə əlavə et';

                svg_area.find( 'svg' ).remove();
                svg_area.prepend( svg );

                text_area.text( text );
                text_area_m.text( text_m );

                if( $( '[x-remove-announcement="' + id + '"]' ).length )
                {
                    if( $( '[x-wishlist_count]' ).length )
                    {
                        let count = Number( $( '[x-wishlist_count]' ).text() );

                        $( '[x-wishlist_count]' ).text( --count );
                    }

                    $( '[x-remove-announcement="' + id + '"]' ).fadeOut( function (){ $( this ).remove() } );
                }

                $( '[x-favorites]' ).html( `
                    <svg class="icon ` + ( favorites ? 'favorite-icon' : 'icon-heart-outline' ) + `">
                        <use xlink:href="https://evelani.az/site/img/icons/icons.svg?v=2022-04-26 00:15:21#icon-heart` + ( favorites ? '' : '-outline' ) + `"></use>
                    </svg>
                    Seçilmişlər
                `);
            }


        

            $( document ).ready( function()
            {  
                loading();
            });
        </script>
<script>



        function inputs()
        {
            let type = $( '[name="announcement_type"]' ).val() ,
                propertyType = $( '[name="property_type"]' ).val();

            $( '[x-input]' ).hide();

            $( '[x-input][x-type-' + type + '][x-property-' + propertyType + ']' ).show();

            if( propertyType == 8 )
            {
                $( '[x-area-span]' ).text( 'sot' );

                $( '[name="area"]' ).attr( 'placeholder' , 'Torpaq sahəsi' );

                $( '[for="area"]' ).html( 'Torpaq sahəsi<i class="fas fa-star-of-life"></i>' );
            }

            else
            {
                $( '[x-area-span]' ).text( 'm²' );

                $( '[name="area"]' ).attr( 'placeholder' , 'Sahə' );

                $( '[for="area"]' ).html( 'Sahə<i class="fas fa-star-of-life"></i>' );
            }

        }


        function cityChange( reset = true )
        {
            let city = $( '[name="city"]' ).val() , regionRequired = false;

            $( '[name="region"]' ).closest( 'div' ).find( '[data-value]' ).hide();

            $( '[name="region"]' ).find( 'option' ).each( function()
            {
                let t = $( this ) , region = t.attr( 'value' );

                if( t.attr( 'x-city' ) == city )
                {
                    $( '[name="region"]' ).closest( 'div' ).find( '[data-value="' + region + '"]' ).show();

                    regionRequired = true;
                }
            } );

            if( reset ) $( '[name="region"]' ).val( 0 ).trigger( 'change' );

            if( regionRequired ) $( '[x-region-div]' ).show();
            else $( '[x-region-div]' ).hide();

            if( city == 1 ) $( '[x-metro-div]' ).show();
            else $( '[x-metro-div]' ).hide();
        }


        function regionChange( reset = true )
        {
            let region = Number( $( '[name="region"]' ).val() ) , districtRequired = false;

            $( '[name="district"]' ).closest( 'div' ).find( '[data-value]' ).hide();

            $( '[name="district"]' ).find( 'option' ).each( function()
            {
                let t = $( this ) , district = t.attr( 'value' );

                if( t.attr( 'x-region' ) == region || district == 0 )
                {
                    $( '[name="district"]' ).closest( 'div' ).find( '[data-value="' + district + '"]' ).show();

                    if( region ) districtRequired = true;
                }
            } );

            if( reset ) $( '[name="district"]' ).val( 0 ).trigger( 'change' );

            if( districtRequired ) $( '[x-district-div]' ).show();
            else $( '[x-district-div]' ).hide();
        }


        function removeBlur()
        {
            let div1 = $( '[x-blur-1]' ) , div2 = $( '[x-blur-2]' );

            div1.addClass( 'step--blur' );
            div2.removeClass( 'step--blur' );

            $('html, body').animate({
                scrollTop: $('[x-blur-2]').offset().top
            }, 700);

            div2.find( '[name="announcement_owner"]' ).val( div1.find( '[name="announcement_owner"]' ).val() );
            div2.find( '[name="email"]' ).val( div1.find( '[name="email"]' ).val() );
            div2.find( '[name="mobile"]' ).val( div1.find( '[name="mobile"]' ).val() );
            div2.find( '[name="user_type"]' ).val( div1.find( '[name="user_type"]:checked' ).val() );
            div2.find( '[name="whatsapp"]' ).val( div1.find( '[name="whatsapp"]' ).prop( 'checked' ) ? 'on' : null );

            div2.find( 'select' ).removeAttr( 'disabled' );
            div2.find( 'select' ).closest( 'div' ).removeClass( 'disabled' );
        }

        function loaded(e) {
            e.preventDefault();
            e.returnValue = '';
        }
        // window.addEventListener('beforeunload', loaded);

        function afterAnnouncementSuccess( data )
        {
            $( '[x-blur-2]' ).addClass( 'step--blur' );

            window.removeEventListener("beforeunload",loaded)

            $( '[x-success-message]' ).text( data.message );

            $( '[x-after-announcement-success]' ).click();
        }


        let files = [];
        let count = 0;

        function fileUpload( e )
        {

            files = Array.prototype.slice.call( e.target.files );


            uploadFile();
        }

        function  uploadFile( i = 0 )
        {
            if( files[ i ] !== undefined )
            {
                var d = new Date();
                var year = d.getFullYear();
                var month = d.getMonth() + 1
                var date = d.getDate();
                var hour = d.getHours();
                var minute = d.getMinutes();
                var second = d.getSeconds();
                var minSec = d.getMilliseconds()
                var dataId = files[ i ].name.replace(/(.*)\.(.*?)$/, "$1").split(" ").join("");
                var imageName = files[ i ].name;

                dataId = dataId.toLowerCase().split(/[\])}[{(]/).join("-").split(/[!@#$%-^&*]/).join("") + `${year}-${month}-${date}-${hour}-${minute}-${second}-${minSec}-${count++}`;

                $( '[x-images]' ).append( _.template( $( 'script[x-photo]' ).html() )( { uniqeId : "x-image-" + dataId,imageName: imageName } ) );

                $( '[x-edit-announcement-button]' ).attr( 'disabled' , 'disabled' );

                if( files[ i + 1 ] !== undefined ) uploadFile( i + 1 );

                let file = files[ i ];


                if( file.type.match( 'image.*' ) )
                {
                    let formData = new FormData();

                    formData.append( '<?php echo $this->security->get_csrf_token_name();?>' , csrf );

                    formData.append( 'path' , file );

                    $.ajax( {
                        xhr: function () {
                            var xhr = new window.XMLHttpRequest();
                            xhr.upload.addEventListener("progress", function (evt) {
                                if (evt.lengthComputable) {
                                    var percentComplete = evt.loaded / evt.total;

                                    $('[x-image-' + dataId + ']').find(".progress-bar").css({
                                        width: percentComplete * 100 + '%'
                                    });
                                    if (percentComplete === 1) {
                                        $('[x-image-' + dataId + ']').find(".progress").addClass('d-none');
                                    }
                                }
                            }, false);
                            xhr.addEventListener("progress", function (evt) {
                                if (evt.lengthComputable) {
                                    var percentComplete = evt.loaded / evt.total;

                                    $('[x-image-' + dataId + ']').find(".progress-bar").css({
                                        width: percentComplete * 100 + '%'
                                    });
                                }
                            }, false);
                            return xhr;
                        },
                        type : 'POST' ,
                        url : '<?= base_url() ?>add_listing/upload' ,
                        data : formData ,
                        cache : false ,
                        contentType : false ,
                        processData : false ,
                        success : function( res )
                        {
                            res = JSON.parse(res);
                            if( res[ 'status' ] === 'success' )
                            {
                                if( res.validations !== undefined && Object.keys( res.validations ).length )
                                {

                                    $( '[x-image]:last-child' ).remove();

                                    $.each( res.validations , function( name , v )
                                    {
                                        $.each( v , function( k , m )
                                        {
                                            warning( m );
                                        } );
                                    } );
                                }
                                else
                                {

                                    let div =  $('[x-image-' + dataId + ']').append( _.template( $( 'script[x-photo-data]' ).html() )( { id : res.photo.id , avatar : '' } ) );

                                    div.prev( '[x-loading]' ).remove();

                                    resizeImage( file , div );

                                    $( '[x-edit-announcement-button]' ).removeAttr( 'disabled' );
                                }
                            }

                            else {

                                warning( res.exception !== undefined ? ( res.exception.message + ' | Line: ' + res.exception.line + ' | File: ' + res.exception.file ) : ( res.warning !== undefined ? res.warning : 'Şəkil üçün yüklədiyiniz faylın ölçüsü çox böyükdür' ) );
                            }
                        } ,
                        error : function( res )
                        {
                            error( 'Network error!' );
                        }
                    } );
                }
            }
        }

        function resizeImage( file , div )
        {
            var canvas = document.createElement("canvas");
            var ctx = canvas.getContext("2d");
            var img = new Image();

            img.onload = function () {
                let n = 0.5;

                canvas.height = canvas.width * (img.height / img.width);
                var oc = document.createElement('canvas'), octx = oc.getContext('2d');
                oc.width = img.width * n;
                oc.height = img.height * n;
                octx.drawImage(img, 0, 0, oc.width, oc.height);
                octx.drawImage(oc, 0, 0, oc.width * n, oc.height * n);
                ctx.drawImage(oc, 0, 0, oc.width * n, oc.height * n, 0, 0, canvas.width, canvas.height);

                div.find( 'img' ).attr( 'src' , canvas.toDataURL() );
                div.find( 'img' ).show();
            }

            img.src = URL.createObjectURL( file );
        }


        $('body').on('click', '.form-gallery__item--rotate', function () {
            var rotationElement = $(this).parent().find('[name="rotation[]"]');
            var img = $(this).parent().find('.form-item__file');
            var rotation = parseInt($(rotationElement).val());
            if ($(this).hasClass("form-gallery__item--rotate--left")) {
                rotation = (rotation - 90) % 360;
            } else if ($(this).hasClass("form-gallery__item--rotate--right")) {
                rotation = (rotation + 90) % 360;
            }
            $(img).css({ 'transform': 'rotate(' + rotation + 'deg)' });
            $(rotationElement).val(rotation);
        });

        $( document ).ready( function()
        {
            $( document ).on( 'change' , '[name="announcement_type"]' , function()
            {
                let type = $( this ).val();

                $( '[name="property_type"]' ).closest( 'div' ).find( '[data-value]' ).hide();

                $( '[name="property_type"]' ).find( 'option' ).each( function()
                {
                    let t = $( this ) , property_type = t.attr( 'value' );

                    if( t.attr( 'x-type-' + type ) !== undefined ) $( '[name="property_type"]' ).closest( 'div' ).find( '[data-value="' + property_type + '"]' ).show();
                } );

                $( '[name="property_type"]' ).val( 0 ).trigger( 'change' );
            } );


            $( document ).on( 'change' , '[name="property_type"]' , function()
            {
                inputs();
            } );


            $( document ).on( 'change' , '[name="city"]' , function()
            {
                cityChange();
            } );


            $( document ).on( 'change' , '[name="region"]' , function()
            {
                regionChange();
            } );


            $( document ).on( 'click' , '[x-upload-photo]' , function() { $( '[x-select-images]' ).click(); } );

            $( document ).on( 'change' , '[x-select-images]' , fileUpload );


            $( document ).on( 'click' , '.form-gallery__item--delete' , function()
            {
                $( this ).closest( '.form-gallery__item' ).fadeOut( function (){ $( this ).remove(); } );
                var imageName = $( this ).attr("data-id")
                files = files.filter(img => img.name !== imageName)
                document.querySelector("[x-select-images]").value = ""
                console.log(document.querySelector("[x-select-images]").files)
            } );

            
            cityChange();

            regionChange();

            inputs();
        } );
    </script>
<script>
        $( () => {
            let formGallery = $( ".form-gallery" );

            formGallery.sortable();

            formGallery.disableSelection();
        } );

    </script>

<script>
        var ruleVisible = $( ".rules-list" ).attr( "class" ).split( ' ' )[ 1 ].substr( 6 , 7 );
        var ruleCount = $( ".rules-list" ).children().length;
        for( var i = 1; i <= ruleVisible; i++ )
        {
            $( ".rules-list__item:nth-child(" + i + ")" ).addClass( "rule-visible" );
        }
        if( ruleVisible >= ruleCount )
        {
            $( ".card-rules a" ).addClass( "d-none" );
        }
        $( ".card-rules a" ).click( function()
        {
            $( ".rules-list__item" ).addClass( "rule-visible" );
            $( this ).addClass( "d-none" );
        } );
    </script>

<script async defer src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCcVxlZlT3nO44ljCnR2f89GqzxkuCQftY&libraries=places&callback=initMap&language=az"></script>
<script>
        function initMap()
        {
            var geocoder = new google.maps.Geocoder();

            var map = new google.maps.Map(
                document.getElementById( 'gmap' ),
                {
                    center : {
                        lat: 40.3913,
                        lng: 49.8666
                    },
                    zoom : 15,
                    // disableDefaultUI: true,
                    mapTypeId: "roadmap",
                    fullscreenControl: true,
                    fullscreenControlOptions : {
                        position : google.maps.ControlPosition.RIGHT_TOP
                    }
                }
            );

            var input = document.getElementById("pac-input");
            var searchBox = new google.maps.places.SearchBox(input);
            map.controls[google.maps.ControlPosition.TOP_LEFT].push(input);

            let markers = [];

            var defaulticon = {
                lat : 40.3913 ,
                lng : 49.8666
            };

            var map = new google.maps.Map(
                document.getElementById( 'gmap' ) ,
                {
                    zoom : 15 ,
                    center : defaulticon
                }
            );

            
            var request = {
                placeId : 'ChIJN1t_tDeuEmsRUsoyG83frY4' ,
                fields : [ 'name' , 'formatted_address' , 'place_id' , 'geometry' ]
            };

            var infowindow = new google.maps.InfoWindow();
            var service = new google.maps.places.PlacesService( map );

            service.getDetails( request , function( place , status )
            {
                if( status === google.maps.places.PlacesServiceStatus.OK )
                {
                    var flag = 0;
                    var x;
                    searchBox.addListener("places_changed", function( event ) {
                        const places = searchBox.getPlaces();

                        if (places.length == 0) {
                            return;
                        }

                        deleteMarkers();

                        const bounds = new google.maps.LatLngBounds();
                        places.forEach((place) => {
                            if (!place.geometry) {
                                console.log("Returned place contains no geometry");
                                return;
                            }

                            placeMarker(place.geometry.location);

                            if (place.geometry.viewport) {
                                bounds.union(place.geometry.viewport);
                            } else {
                                bounds.extend(place.geometry.location);
                            }
                            $("#map-id").attr('src',`https://maps.googleapis.com/maps/api/staticmap?center=${place.geometry.location.lat()},${place.geometry.location.lng()}&zoom=11&size=360x220&maptype=roadmap&markers=${place.geometry.location.lat()},${place.geometry.location.lng()}&key=AIzaSyCcVxlZlT3nO44ljCnR2f89GqzxkuCQftY`);
                            document.getElementById( "latitude" ).value = place.geometry.location.lat();
                            document.getElementById( "longitude" ).value = place.geometry.location.lng();
                            // geocoder.geocode( {
                            //     'latLng' : place.geometry.location
                            // } , function( results , status )
                            // {
                            //     if( status == google.maps.GeocoderStatus.OK )
                            //     {
                            //         if( flag == 0 )
                            //         {
                            //             if( results[ 0 ] && document.getElementById( "location" ).value == "" )
                            //             {
                            //                 document.getElementById( "location" ).value = results[ 0 ].formatted_address;
                            //                 flag = 1;
                            //             }
                            //             else
                            //             {
                            //                 x = document.getElementById( "location" ).value;
                            //             }
                            //         } else
                            //         {
                            //             if( results[ 0 ] && document.getElementById( "location" ).value != x )
                            //             {
                            //                 document.getElementById( "location" ).value = results[ 0 ].formatted_address;
                            //             } else
                            //             {
                            //                 document.getElementById( "location" ).value = x;
                            //             }
                            //         }
                            //     }
                            // } );
                        });
                        map.fitBounds(bounds);
                    });
                    map.addListener("bounds_changed", () => {
                        searchBox.setBounds(map.getBounds());
                    });
                    google.maps.event.addListener( map , 'click' , function( event )
                    {

                        $("#map-id").attr('src',`https://maps.googleapis.com/maps/api/staticmap?center=${event.latLng.lat()},${event.latLng.lng()}&zoom=11&size=360x220&maptype=roadmap&markers=${event.latLng.lat()},${event.latLng.lng()}&key=AIzaSyCcVxlZlT3nO44ljCnR2f89GqzxkuCQftY`)

                        deleteMarkers();
                        placeMarker( event.latLng );
                        // geocoder.geocode( {
                        //     'latLng' : event.latLng
                        // } , function( results , status )
                        // {
                        //     if( status == google.maps.GeocoderStatus.OK )
                        //     {
                        //         if( flag == 0 )
                        //         {
                        //             if( results[ 0 ] && document.getElementById( "location" ).value == "" )
                        //             {
                        //                  document.getElementById( "location" ).value = results[ 0 ].formatted_address;
                        //                  flag = 1;
                        //             } else
                        //             {
                        //                 x = document.getElementById( "location" ).value;
                        //             }
                        //         } else
                        //         {
                        //             if( results[ 0 ] && document.getElementById( "location" ).value != x )
                        //             {
                        //                document.getElementById( "location" ).value = results[ 0 ].formatted_address;
                        //             } else
                        //             {
                        //                  document.getElementById( "location" ).value = x;
                        //             }
                        //         }
                        //     }
                        // } );

                        document.getElementById( "latitude" ).value = event.latLng.lat();
                        document.getElementById( "longitude" ).value = event.latLng.lng();

                    } );

                    function placeMarker( location )
                    {

                        var marker = new google.maps.Marker( {
                            position : location ,
                            map : map
                        } );
                        markers.push( marker );
                    }

                    function setMapOnAll( map )
                    {
                        for( var i = 0; i < markers.length; i++ )
                        {
                            markers[ i ].setMap( map );
                        }
                    }

                    function clearMarkers()
                    {
                        setMapOnAll( null );
                    }

                    function deleteMarkers()
                    {
                        clearMarkers();
                        markers = [];
                    }
                }

            } );
        }
    </script>
<script>
        $( function()
        {
            $( '[data-toggle="tooltip"]' ).tooltip()
        } )
    </script>
<script>
        function isNumberKey( evt )
        {
            var charCode = ( evt.which ) ? evt.which : event.keyCode
            if( charCode > 31 && ( charCode < 48 || charCode > 57 ) && charCode != 46 )
                return false;
            return true;
        }
    </script>

<script>
        function readfiles(files) {
            for (var i = 0; i < files.length; i++) {
                reader = new FileReader();
                reader.readAsDataURL(files[i]);
            }
        }
        var holder = document.getElementById('addform');
        holder.ondragover = function () { return false; };
        holder.ondragend = function () { return false; };
        holder.ondrop = function (e) {

            e.preventDefault();
            readfiles(e.dataTransfer.files);
            files = Array.prototype.slice.call( e.dataTransfer.files );
            uploadFile();
        }
    </script>
<script type="text/template" x-validation>
            <p class="form-message form-message--error">
                <svg class="icon icon-triangle-error">
                    <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg?#icon-triangle-error""></use>
                </svg>
                <span><%- rc.message %></span>
            </p>
        </script>
<script type="text/template" x-success>
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-body">
                        <h6 class="modal-title mt-5 text-center"><%- rc.message %></h6>
                        <% if( rc.linkAfterClose !== undefined ) { %>
                            <a class="link-button link-button--primary mx-auto mt-5 px-4" href="<%- rc.linkAfterClose.length ? rc.linkAfterClose : 'https://evelani.az/az' %>">Bağla</a>
                        <% } else { %>
                        <button class="link-button link-button--primary mx-auto mt-5 px-4" data-dismiss="modal">Bağla</button>
                        <% } %>
                        <div class="modal-close" data-dismiss="modal">
                            <svg class="icon icon-close">
                                <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-close"></use>
                            </svg>
                        </div>
                    </div>
                </div>
            </div>
        </script>
<script type="text/template" x-email-success>
            <div class="modal-dialog">
                <div class="modal-content">
                    <div class="modal-header">
                        <div class="modal-close" data-dismiss="modal">
                            <svg class="icon icon-close">
                                <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-close"></use>
                            </svg>
                        </div>
                    </div>
                    <div class="modal-body">
                        <svg class="icon icon-message-sent">
                            <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-message-sent"></use>
                        </svg>
                        <h6><%- rc.title %></h6>
                        <p><%= rc.text %></p>
                        <button class="link-button link-button--primary" data-dismiss="modal">Bağla</button>
                    </div>
                </div>
            </div>
        </script>
<script type="text/template" x-image>
        <div class="form-gallery__item" x-image-id="<%- rc.id %>"  >
            <a class="form-gallery__item--delete" x-image-delete>
                <svg class="icon icon-close">
                    <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-close"></use>
                </svg>
            </a>
            <input name="images[]" value="<%- rc.id %>" type="hidden">
            <input name="rotation[]" value='0' type="hidden">
            <img src="<%- media(rc.avatar) %>" class="form-item__file">
        </div>
    </script>
<script type="text/template" x-photo>
        <div class="form-gallery__item" x-image id="<%- rc.uniqeId %>" <%- rc.uniqeId %>  >
            <a class="form-gallery__item--delete" data-id="<%- rc.imageName %>">
                <svg class="icon icon-close">
                    <use xlink:href="<?= base_url() ?>assets/site/img/icons/icons.svg#icon-close"></use>
                </svg>
            </a>


            <div x-loading style="position: absolute;">
                <svg class="spinner" viewBox="0 0 50 50">
                    <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
                </svg>
            </div>
            <div class="progress image-progress">
                <div class="progress-bar" role="progressbar" style="width: 0%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
        </div?>
    </script>
<script type="text/template" x-photo-data>
        <div x-loading style="position: absolute;">
            <svg class="spinner" viewBox="0 0 50 50">
                <circle class="path" cx="25" cy="25" r="20" fill="none" stroke-width="5"></circle>
            </svg>
        </div>
        <img x-image-src style="z-index: 999; position: absolute; display: none;" src="<%- rc.avatar %>" class="form-item__file">
        <input name="images[]" value="<%- rc.id %>" type="hidden">
        <input name="rotation[]" value='0' type="hidden">
    </script>
<script>
            $( function()
            {
                $( '[data-toggle="tooltip"]' ).tooltip()
            } )
        </script>
<script>
            // calc
            $( ".reset-button" ).click( function()
            {
                return false; // prevent submitting

            } );
            $( ".reset-button" ).click( function()
            {
                $( '.block-footer p .cost span' ).text( '0' );
                $( '#calculator .range input' ).val( 0 )
                $( '#calculator .pull-right input' ).val( 0 )
            } )

            $( '.counter-num' ).each( function()
            {
                let $this = $( this );
                jQuery( { Counter : 0 } ).animate( { Counter : parseInt( $this.attr( "data-number" ) ) } , {
                    duration : 1000 ,
                    easing : 'swing' ,
                    step : function( now )
                    {
                        var num = Math.ceil( now ).toString();
                        if( Number( num ) > 999 )
                        {
                            while( /(\d+)(\d{3})/.test( num ) )
                            {
                                num = num.replace( /(\d+)(\d{3})/ , '$1' + ' ' + '$2' );
                            }
                        }
                        $this.text( num );
                    }
                } );
            } );


            var config = {
                c1 : {
                    km : 300 , // Kreditin müddəti
                    gkm : 360 , // Güzəştli kreditin müddəti
                    kf : 8 , //Kredit faizi (illik)
                    gkf : 4 , // Güzəştli kredit faizi (illik)
                    ausx : 190 , // Ailə üzvlərinin saxlanma xərci
                    amge : 0.7 , // Aylıq məcmu gəlir əmsalı
                    eosx : 0.008 , // Ehtimal olunan sığorta xərci
                    kmm : 150000 , // Kreditin maksimal məbləği
                    gkmm : 100000 , // Güzəştli kreditin maksimal məbləği
                    miof : 0.15 , // Minimal ilkin ödəniş faizi
                    gmiof : 0.1 // Güzəştli minimal ilkin ödəniş faizi
                } , c2 : {
                    bokb : 0.004 , // Bankın ödəyəcəyi komissiyalar - Birdəfəlik
                    mkm : 5000000 , // Maksimal kredit məbləği
                    gmkm : 10000000 , // Güzəştli maksimal kredit məbləği
                    mkm1 : 12 , // Maksimal kredit müddəti birinci şərt
                    mkm2 : 24 , // Maksimal kredit müddəti ikinci şərt
                    mkm3 : 84 , // Maksimal kredit müddəti üçüncü şərt
                    mgm1 : 11 , // Maksimal güzəşt müddəti birinci şərt
                    mgm2 : 23 , // Maksimal güzəşt müddəti ikinci şərt
                    mgm3 : 24 , // Maksimal güzəşt müddəti üçüncü şərt
                    msm : 36 // Maksimal subsidiya müddəti birinci şərt
                } , c3 : {
                    mi : 20000 , // Aylıq məcmu gəlir əmsalı
                    ol : 2000 , // Digər öhdəliklər
                    ht : 300 , // Kirayənin müddəti
                }
            };


            var acc = document.getElementsByClassName( "accordion" );
            var i;

            for( i = 0; i < acc.length; i++ )
            {
                acc[ i ].addEventListener( "click" , function()
                {
                    //hide news and statistics and calculator div
                    $( '.article-section' ).hide();
                    $( '.cal' ).hide();

                    //banners
                    let cat_id = this.getAttribute( 'data-banner-id' );
                    $( '.banners-block a' ).hide();
                    $( '.ban' + 0 ).show();
                    $( '.ban' + cat_id ).show();

                    // sub categories
                    $( '.subCategory' ).hide();
                    $( '.sub-' + cat_id ).show();

                    // $('.banners-block a').show();
                    this.classList.toggle( "active" );
                    var panel = this.nextElementSibling;
                    if( panel.style.display === "block" )
                    {
                        panel.style.display = "none";
                    } else
                    {
                        panel.style.display = "block";
                    }
                } );
            }

            $( '.cal-button ' ).on( 'click' , function()
            {
                //hide news and statistics div
                $( '.subCategory' ).hide();

                let id = $( this ).attr( 'data-id' );
                $( '.cal' ).hide();
                $( '#calculator' + id ).show();
                $( '.statistics-section' ).hide();
            } );

            $( document ).ready( function()
            {
                $( '.banners-block .ban' + 2 ).hide();
                $( '.banners-block .ban' + 3 ).hide();
            } );

            function checkAccept( t )
            {
                if( $( '#check-accept' ).is( ":checked" ) )
                {
                    $( '.payment-button' ).show();
                } else
                {
                    $( '.payment-button' ).hide();
                }
            }

            function checkPayment( t )
            {
                $( '#message' ).show();
            }

            function goSite()
            {
                $( '#check-accept' ).attr( 'checked' , false );
                $( '.payment-button' ).hide();
                window.open( 'https://gpp.az/GPEWebPortal/Infosite/RedirectFromSc/981600/aHR0cDovL21jZ2YuYXovPy9hei9tZW51LzU0Lw==' , '_blank' );
            }

            var widId = "";
            var onloadCallback = function()
            {
                widId = grecaptcha.render( 'recapchaWidget' , {
                    'sitekey' : '6Ld5ZrcUAAAAAPQwsqzt56U8Aa49WIAqCdTluw_o'
                } );
            };
            $( '.carousel' ).carousel( {
                interval : 2000
            } )
            $( '.language-switch' ).change( function()
            {
                var locale = $( this ).val();
                window.location.href = '/locale/' + locale;
            } );

            // var swiperAnimation = new SwiperAnimation();
            // var swiper1 = new Swiper( '.s1' , {
            //     direction : 'vertical' ,
            //     pagination : {
            //         el : '.swiper-pagination' ,
            //         clickable : true ,
            //     } ,
            //     autoplay : {
            //         delay : 15000 ,
            //     } ,
            //     bulletClass : 'swiper-pagination-bullet' ,
            //     bulletActiveClass : 'swiper-pagination-bullet-active' ,
            //
            // } );
            // var swiper2 = new Swiper( '.s2' , {
            //     direction : 'vertical' ,
            //     pagination : {
            //         el : '.swiper-pagination' ,
            //         clickable : true ,
            //     } ,
            //     autoplay : {
            //         delay : 15000 ,
            //     } ,
            //     bulletClass : 'swiper-pagination-bullet' ,
            //     bulletActiveClass : 'swiper-pagination-bullet-active' ,
            // } );
            //
            // var swiper3 = new Swiper( '.s3' , {
            //     direction : 'vertical' ,
            //     pagination : {
            //         el : '.swiper-pagination' ,
            //         clickable : true ,
            //     } ,
            //     autoplay : {
            //         delay : 15000 ,
            //     } ,
            //     on : {
            //         init : function()
            //         {
            //             swiperAnimation.init( this ).animate();
            //         } ,
            //         slideChange : function()
            //         {
            //             $( '.counter-num' ).each( function()
            //             {
            //                 let $this = $( this );
            //                 jQuery( { Counter : 0 } ).animate( { Counter : parseInt( $this.attr( "data-number" ).replace( / /g , "" ) ) } , {
            //                     duration : 1000 ,
            //                     easing : 'swing' ,
            //                     step : function( now )
            //                     {
            //                         var num = Math.ceil( now ).toString();
            //                         if( Number( num ) > 999 )
            //                         {
            //                             while( /(\d+)(\d{3})/.test( num ) )
            //                             {
            //                                 num = num.replace( /(\d+)(\d{3})/ , '$1' + ' ' + '$2' );
            //                             }
            //                         }
            //                         $this.text( num );
            //                     }
            //                 } );
            //             } );
            //             swiperAnimation.init( this ).animate();
            //         }
            //     } ,
            //     bulletClass : 'swiper-pagination-bullet' ,
            //     bulletActiveClass : 'swiper-pagination-bullet-active' ,
            // } );


            function showUl( t )
            {
                let parent = $( t ).parents( "li" );
                let ul = parent.find( 'ul' );
                if( ul.hasClass( 'show' ) )
                {
                    ul.removeClass( 'show' );
                } else
                {
                    ul.addClass( 'show' );
                }
            }

            // var top1 = $(".main-body").width()
            // var top2 = $(".banner-left--home").width()
            // var alltop = top1 - top2
            // console.log(top1);
            // console.log(document.getElementById("main-body").getBoundingClientRect())
            // $('.banner-left--home').css("top", top2 + 'px');
            // $('.banner-right--home').css("top", '320px');
        </script>
<script>
            $('.announcement-slider').swipeCarousel({});
            var y = document.getElementsByClassName('announcement-slider');
            for (var i = 0; i < y.length; i++) {
                var section = y[i];
                var x = $(y[i]).attr("id");
                if($("#" +x+ " .carousel-inner").children().length < 3){
                    $("#" +x+ " .carousel-indicators").addClass("d-none");
                }
            }
            $('.announcement-slider .carousel-indicators  li').on('mouseover',function(){
                $(this).trigger('click');
            })
        </script>
<script>
            function isNumberKey( evt )
            {
                var charCode = ( evt.which ) ? evt.which : event.keyCode
                if( charCode > 31 && ( charCode < 48 || charCode > 57 ) && charCode != 46 )
                    return false;
                return true;
            }
            $('.select2').select2();
            $( document ).ready( function()
            {
                // if(($('body').height() - window.innerHeight) < 114){
                //     $('.banner-left').css({
                //         height: $('body').height() - 114
                //     });
                //     $('.banner-left img').css({
                //         height: $('body').height() - 114
                //     });
                //     $('.banner-right').css({
                //         height: $('body').height() - 114
                //     });
                //     $('.banner-right img').css({
                //         height: $('body').height() - 114
                //     });
                // }
                $('#locationSearch').on('shown.bs.modal', function () {
                    if(window.matchMedia("(min-width: 768px)").matches){
                        $('.select2-modal').select2({
                            dropdownParent: $('#locationSearch')
                        });
                        $('.select2-modal').on('select2:open', function(e) {
                            $('input.select2-search__field').prop('placeholder', 'Axtar');
                        });
                    }
                });
                if(window.matchMedia("(max-width: 768px)").matches){
                    $("#locationSearch .modal-content").height(window.innerHeight);
                    $("#locationSearch .modal-body").height(window.innerHeight - 185);
                    $("#locationSearch .modal-body__content").height(window.innerHeight - 261);

                    $("#advancedSearch .modal-content").height(window.innerHeight);
                    $("#advancedSearch .modal-body").height(window.innerHeight - 185);

                    $("#make-announcement-premium .modal-content").height(window.innerHeight);
                    $("#make-announcement-premium .modal-body").height(window.innerHeight - 60);

                    $("#make-announcement-vip .modal-content").height(window.innerHeight);
                    $("#make-announcement-vip .modal-body").height(window.innerHeight - 60);

                    $("#pull-forward-announcement .modal-content").height(window.innerHeight);
                    $("#pull-forward-announcement .modal-body").height(window.innerHeight - 60);

                    $("#mortgagemodal1 .modal-content").height(window.innerHeight);
                    $("#mortgagemodal1 .modal-body").height(window.innerHeight - 60);

                    $("#mortgagemodal .modal-content").height(window.innerHeight);
                    $("#mortgagemodal .modal-body").height(window.innerHeight - 60);
                }
            });
            $('.targetsAds')
              .dropdown({
                maxSelections: 4
              });
        </script>
</body>
</html>